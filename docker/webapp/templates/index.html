{% extends "layout.html" %}
{% block content %}
  <div>
    <section class="page-header">
      <h1><span>MELPA</span> <small>(Milkypostmanâ€™s Emacs Lisp
          Package Archive)</small></h1>
    </section>
    <div class="row">
      <div class="col-md-8">
        <section class="jumbotron">
          <ul>
            <li><strong>Up-to-date packages built on our servers from upstream source</strong></li>
            <li><strong>Installable in any Emacs with 'package.el'</strong> - no local version-control tools needed</li>
            <li><strong>Curated</strong> - no obsolete, renamed, forked or randomly hacked packages</li>
            <li><strong>Comprehensive</strong> - more packages than any other archive</li>
            <li><strong>Automatic updates</strong> - new commits result in new packages</li>
            <li><strong>Extensible</strong> - contribute new recipes, and we'll build the packages</li>
          </ul>
        </section>
      </div>
      <div class="col-md-4">
        <div class="alert alert-warning">
          <strong>Current build started:</strong> <span>xxxx an hour
            ago</span><span>, last took 2 hours</span>
        </div>
      </div>
    </div>
    <section id="packages">
      <form method="get">
        <h2>Current List of {{ total_packages }} Packages <small>{{ downloads }} downloads to date</small></h2>
        <p>
          <input type="search" placeholder="Enter search terms" autofocus="" class="form-control" name="q" value="{{ q }}">
          <span class= "help-block">{{ match_count }} matching package(s)</span>
        </p>
        <table id="package-list" class="table table-bordered table-responsive table-hover">
          <thead>
            <tr>
              {% for title, sort_key in [["Package", "package"], ["Description", None], ["Version", "version"], ["Recipe", None], ["Source", "source"], ["DLs", "downloads"]] %}
                {% if sort_key %}
                  <th class="sortable"
                      {% if sort == sort_key %}
                        aria-sort="{{ asc and "ascending" or "descending" }}"
                      {% endif %}>
                      <a href="{{ request.url.include_query_params(sort=sort_key, asc=(not asc if sort == sort_key else True)) }}">{{title}}
                        {% if sort == sort_key %}
                          <span class="glyphicon {{ asc and "glyphicon-chevron-down" or "glyphicon-chevron-up" }}"></span>
                        {% endif %}
                      </a>
                  </th>
                {% else %}
                  <th>{{title}}</th>
                {% endif %}
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for package in packages %}
              <tr>
                <td>
                  <a href="/p/{{package.name}}">{{package.name}}</a>
                </td>
                <td>
                  <a href="/p/{{package.name}}">{{package.description}}</a>
                </td>
                <td class="version">
                  <a href=
                     "{{package.download_url}}">{{package.version}}
                     <span class="glyphicon glyphicon-download"></span></a>
                </td>
                <td class="recipe">
                  <a href=
                     "{{package.recipe_url}}">
                     <span class="glyphicon glyphicon-cutlery"></span></a>
                </td>
                <td class="source">
                  <a href=
                     "{{package.source_url}}">
                     {{package.fetcher}}</a>
                </td>
                <td>{{package.downloads}}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </form>
    </section>
  </div>
{% endblock %}
